## 1 开篇

> `yaflib` 是一个给 `Yaf` 框架提供 `MySQL`、`Redis`、`Session`、`Cookie`、日志、文件上传、图片操作、多进程任务、分布式锁等等功能的工具类库。目前类库在作者的公司项目以及自己的项目中大量应用，完全满足日常的开发需求。请各位放心使用！如果遇到使用中的问题，可以通过 `issues ` 反馈。

### 1.1、前世今生

作者在 2014 年的时候接触到 `Yaf` 框架并一直学习并应用到自己的公司项目之中。刚开发接触的时候被它的性能与简洁深深的吸引。也同时非常感慨 `Yaf` 框架太过简洁连基本的 `ORM` 等功能都未提供。于是，作者通过借鉴其它框架写了一套工具库。起初，这套工具库与 `Yaf` 深度绑定一起。每次发现 BUG 或功能变更之后，所有的项目都要来回进行代码的合并。于是就想着把这套工具库单独拎出来发布到 `packagist` ，通过 `Composer ` 包管理工具进行安装升级。

> ***注***：`yaflib` 不仅仅可以与 `Yaf` 框架珠联璧合，同时也可以在任何 Web 项目之中加载使用。它仅仅只是一个工具库。没有 `MVC` 相关联的功能存在。

### 1.2、环境版本

```
PHP   -> PHP 7.2 +
Redis -> Redis 3.x +
MySQL -> MySQL 5.6 +
```



### 1.3、依赖

`yaflib` 实现了实现了很多的功能。而这些功能是建立在常见的第三方 `PHP` 类库实现。

#### 1.3.1 Redis 扩展

`yaflib` 中的缓存、分布式锁均依赖 `Redis`。请确保 `Redis` 服务器版本在 3.0 以上。

```
> pecl install redis
```

以上命令会自动安装 `Redis C` 扩展。如果您的系统环境没有 `pecl` 命令，可以使用传统的源码安装方式。

安装之后，再在 `php.ini` 配置文件中添加如下代码：

```
extension = redis.so
```

同时记得重启 `php-fpm`。

***源码安装方式如下：***

```
> wget http://pecl.php.net/get/redis-4.1.0.tgz
> tar zxvf redis-4.1.0.tgz
> cd redis-4.1.0
> phpize
> make && make install
```

然后，在 `php.ini` 配置文件末尾增加如下代码:

```
extension = redis.so
```

同样也要重启 `php-fpm`。

#### 1.3.2 其他扩展

在开发中，我们会使用到 `PHP` 内置的一些类与方法。而这些方法需要 `PHP` 内置扩展的支持。有些内置扩展默认是关闭的。所以，我们需要确认以下扩展已经正常安装并且是启用状态。

```
posix
pcntl
openssl
mcrypt
fileinfo
json
ftp
gd
ctype
```

> 注：之前作者碰到过有些 `PHP` 运行环境会把默认扩展禁用的情况。解决些问题的办法是找到当前 `php` 版本对应的源码，再找到这个源码里面的扩展目录。像安装普通 C 扩展一样安装即可正常加载使用。



下一小节，我们将介绍 `yaflib` 的功能以及快速入门技巧。